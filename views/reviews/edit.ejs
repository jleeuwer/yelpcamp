<% include ../partials/header %>

<!-- Show Campground data -->
<div class="row">
    <div class="col-md-3">
        <p class="lead">
            Yelpcamp
        </p>
        <!-- Map placeholder -->
        <div id="map">

        </div>
    </div>
    <div class="col-md-9">
        <div class="card">
            <img class="img-card-img-top" src="<%= campground.Image%>" height="400"  alt="" srcset="">
            <div class="card-body">
                <div class="card-title">
                    <h4 class="pull-left">
                        <a>
                            <%= campground.Name %>
                        </a>
                    </h4>
                </div>
                <h4 class="text-right">â‚¬ <%= campground.Price %> per night</h4>
                <br>
                <br>
                <p>
                    <%= campground.Description %>
                </p>
                <p>
                    <em>
                        Submitted by <a href="/users/<%= campground.Author.id %>"> <%= campground.Author.username %></a>, <%= moment(campground.CreatedAt).fromNow() %>
                    </em>
                </p>
                <div style="padding-bottom: 10px;">
                </div>
            </div>
        </div>
    </div> 
</div>

<div class="row mt-4">
    <div class="col md-3">
        <!-- Nothing here -->
    </div>
    <div class="col-md-9">
        <form action="/campgrounds/<%= campground_id %>/reviews/<%= review._id %>?_method=PUT" method="POST">
            <div class="form-group">
                <ul class="rate-area">
                    <input type="radio" id="5-star" name="review[rating]" value="5" <% if (review.rating === 5) { %> checked="checked" <% }; %>) />
                    <label for="5-star" title="Amazing">5 stars</label>
                    <input type="radio" id="4-star" name="review[rating]" value="4" <% if (review.rating === 4) { %> checked="checked" <% }; %>) />
                    <label for="4-star" title="Good">4 stars</label>
                    <input type="radio" id="3-star" name="review[rating]" value="3" <% if (review.rating === 3) { %> checked="checked" <% }; %>) />
                    <label for="3-star" title="Average">3 stars</label>
                    <input type="radio" id="2-star" name="review[rating]" value="2" <% if (review.rating === 2) { %> checked="checked" <% }; %>) />
                    <label for="2-star" title="Not Good">2 stars</label>
                    <input type="radio" id="1-star" name="review[rating]" value="1" <% if (review.rating === 1) { %> checked="checked" <% }; %>) />
                    <label for="1-star" title="Bad">1 star</label>
                </ul>
            </div>
            <div class="form-group">
                <textarea id="review-text" class="form-control" type="text" name="review[text]" value="review[text]" placeholder="Write a review for this campground..." rows="5"><%= review.text %></textarea>
            </div>
            <div class="form-group">
                <button id="submit-data" disabled="" class="btn btn-primary btn-block">Save Review</button>
            </div>
        </form>
    </div>
</div>



<% include ../partials/footer.ejs %>

<script>
	// $('form')
	// 	.each(function(){
	// 		$(this).data('serialized', $(this).serialize())
	// 	})
    //     .on('change input', function(){
    //         $(this)				
    //             .find('input:submit, button:submit')
    //                 .attr('disabled', $(this).serialize() == $(this).data('serialized'))
    //         ;
    //      })
	// 	.find('input:submit, button:submit')
	// 		.attr('disabled', true)
    // ;
    
    // Disable the forms submissions until they have changed
    // This function will enable or disable the Submit Button, based on the fact
    // if data on the form has changed 
    $(window).on('load', function (e) {
        $('form').each(function(){
            $(this).data('serialized', $(this).serialize())
        })
        .on('change input', function(){
            $(this).find(':submit, input[type="image"]')
                .prop('disabled', $(this).serialize() == $(this).data('serialized'));

            /* Check if input with type files has changed */
            var changedFiles = $( ":file" ).filter(function( index ) {
                return this.value != this.defaultValue;
            }).length;

            if ( changedFiles > 0) {
                $(this).find(':submit, input[type="image"]')
                    .prop('disabled', false);
            }
        })
        .find(':submit, input[type="image"]').prop('disabled', true);
    });
</script>
